package com.trio.util;

import org.zkoss.zk.ui.Session;
import org.zkoss.zk.ui.Sessions;

import com.trio.base.TrioBasePage;
import com.trio.bean.h000.HondaH000Gates;

public class LoginManager extends TrioBasePage {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

	private static final String KEY_USER_MODEL = LoginManager.class
			.getName()+"_MODEL";

	HondaH000Gates user;
	
	
	private LoginManager () {
		
	}
	
	public static LoginManager getIntance(){
		return getIntance(Sessions.getCurrent());
	}
	
	public static LoginManager getIntance(Session zkSession) {

		synchronized (zkSession) {
			
			LoginManager loginModel = (LoginManager) zkSession.getAttribute(KEY_USER_MODEL);
			if(loginModel == null){
				zkSession.setAttribute(KEY_USER_MODEL, 
						loginModel = new LoginManager());
			}
			return loginModel;
		}
	}
	
	public synchronized void logIn(String name, String Password){
		HondaH000Gates tempUser = getMasterFacade().getHondaH000GatesDao().findByHondaH000GatesName(name);
		
		if(tempUser != null && tempUser.getDbcode().equals(Password)){
			user = tempUser;
		}else{
			user = null;
		}
	}
	
	public void logOff(){
		user = null;
	}
	
	public synchronized HondaH000Gates getUser(){
		return user;
	}
	
	public synchronized boolean isAuthenticated(){
		return user != null;
	}
}
